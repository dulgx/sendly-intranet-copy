/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see legal.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[5],{338:function(ha,da,f){function ba(e,f,h){f.endsWith("/")||(f+="/");h=h||{};var n=h.disableWebsockets||!1;this.EM=h.singleServerMode||!1;f.endsWith("blackbox/")||(f+="blackbox/");this.zl=h.uploadData||null;this.Zs=h.uriData||null;this.SG=h.cacheKey||null;this.Of=Object(r.a)(f,null,n);this.Ge=f;this.bA=e;this.Ze=null;this.Hj=ea();this.dm=ea();this.$u=!1;this.Lf=this.Md=this.$d=this.Ee=null;this.gf=[];this.Ev=[];this.cache={};this.timeStamp=
0;this.zf=[];this.Ag=[];this.qA=null;this.Vz=!1;this.KC=this.id=null;this.JB=this.CJ=fa;this.nx=0;this.gB=!1;this.sY=1;this.Fw={};this.dw=null;this.sp(!0)}function ea(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,Mm:function(){return 1===(e.state&1)},CX:function(){return 2===(e.state&2)},jh:function(){return!e.CX()&&!e.Mm()},pX:function(){return 4===(e.state&4)},$L:function(){e.state|=4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===
e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function fa(){return!1}function ca(e,f,h){if(!(f in y))return!0;f=y[f];for(var n=0;n<f.length;n++){var r=e;var w=f[n];var x=h;if(w.name in r){var z="",ba=!1;r=r[w.name];switch(w.type){case "s":z="String";ba=Object(aa.isString)(r);break;case "a":z="Array";ba=Object(aa.isArray)(r);break;case "n":z="Number";ba=Object(aa.isNumber)(r)&&Object(aa.isFinite)(r);
break;case "o":z="Object",ba=Object(aa.isObject)(r)&&!Object(aa.isArray)(r)}ba||x.reject('Expected response field "'+w.name+'" to have type '+z);w=ba}else x.reject('Response missing field "'+w.name+'"'),w=!1;if(!w)return!1}return!0}f.r(da);var aa=f(0);f.n(aa);var z=f(1);ha=f(39);var w=f(29),r=f(355),n=f(71);f=f(281);var y={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",
type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};ba.prototype=Object(aa.extend)(ba.prototype,{MS:function(){var e=this;return new Promise(function(f,h){var n=new XMLHttpRequest;n.open("GET",e.Ge+"ck");n.withCredentials=e.Bm();n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?f():h())};
n.send()})},I_:function(e,f){this.CJ=e||fa;this.JB=f||fa},gH:function(){var e=this;this.dm=ea();this.Hj=ea();return this.Of.lA().then(function(){e.$u=!1;e.id=null;e.Vz=!1;return e.MS()})},yC:function(){this.CJ();this.ow();this.Ee&&(this.Ee.jh()?this.$e(this.Ee.request):this.Ee.Mm()&&this.JB(this.Ee.result.url,"pdf")&&(this.Ee=null,this.yL()));this.Lf&&this.Lf.jh()&&this.$e(this.Lf.request);this.$d&&this.$d.jh()?this.$e(this.$d.request):this.Md&&this.Md.jh()&&this.qJ(this.Md.request);var e;for(e=0;e<
this.zf.length;e++)this.zf[e]&&this.zf[e]&&(this.zf[e].jh()?this.$e(this.zf[e].request):this.zf[e].Mm()&&this.JB(this.zf[e].result.url,"image")&&(this.zf[e]=null,this.kx(e)));for(e=0;e<this.Ag.length;e++)this.Ag[e]&&this.Ag[e]&&this.Ag[e].jh()&&!this.Ag[e].pX()&&this.$e(this.Ag[e].request);for(e=0;e<this.gf.length;e++)this.gf[e]&&this.gf[e].jh()&&this.$e(this.gf[e].request)},ow:function(){var e=this;this.$u||(this.timeStamp=Date.now(),this.Of.kD(function(f){e.EY(f)}).then(function(){clearInterval(e.mC);
e.mC=null},function(f){Object(z.e)("Blackbox connection failed:"+f);e.$u=!1;if(!e.mC){var h=0;e.Vz=!0;e.KC=0;e.mC=setInterval(function(){50>h++&&e.yC()},5E3)}}),this.$u=!0)},A1:function(){var e=this,f=createPromiseCapability();if(this.zl){var h=new FormData;h.append("file",this.zl.fileHandle,this.zl.fileHandle.name);var n=this.zl.loadCallback;var r="upload";var y=this.zl.extension}else if(this.Zs){h={uri:this.Zs.uri,I4:this.Zs.shareId};h=Object.keys(h).map(function(e){return e+"="+(h[e]?encodeURIComponent(h[e]):
"")}).join("&");var z="application/x-www-form-urlencoded; charset=UTF-8";n=this.Zs.loadCallback;r="url";y=this.Zs.extension}else return Promise.resolve();var aa=new XMLHttpRequest;aa.open("POST",Object(w.h)(e.Ge,"AuxUpload?ext="+y+"&type="+r+"&bcid="+this.Of.clientId));aa.withCredentials=this.Bm();z&&aa.setRequestHeader("Content-Type",z);aa.addEventListener("load",function(){if(aa.readyState===aa.DONE&&200===aa.status){var h=JSON.parse(aa.response);e.bA=h.uri;n(h);f.resolve(h)}});aa.addEventListener("error",
function(){f.reject(aa.statusText+" "+JSON.stringify(aa))});this.zl&&null!=this.zl.onProgress&&(aa.upload.onprogress=function(f){e.zl.onProgress(f)});aa.send(h);return f.promise},Z_:function(e){this.dw=e},sW:function(e){this.password&&this.Hj.Mm()?e(this.password):this.dw(e)},DZ:function(e){this.password=e||null;this.Hj.Mm()||(this.ow(),this.$e({t:"pages"}));return this.Hj.promise},Gs:function(e){this.qA=e||null;this.Hj.Mm()||(this.ow(),this.$e({t:"pages"}));return this.Hj.promise},iH:function(e){e=
Object.assign(e,{uri:encodeURIComponent(this.bA)});this.qA&&(e.ext=this.qA);this.Ze&&(e.c=this.Ze);this.password&&(e.pswd=this.password);this.SG&&(e.cacheKey=this.SG);return e},$e:function(e){e=this.iH(e);this.Of.send(e)},bj:function(e){return e},EY:function(e){var f=this,h=e.data,r=e.err,w=e.t;if(r&&f.dw&&"This document could not be decrypted with the given password"===r)f.dw(function(e){f.DZ(e)});else switch(w){case "upload":r?f.B1.reject(r):f.B1.resolve("Success");break;case "pages":r?f.Hj.reject(r):
ca(h,w,f.Hj)&&f.Hj.resolve(h);break;case "config":r?f.dm.reject(r):ca(h,w,f.dm)&&(h.id&&(f.id=h.id),h.serverVersion&&(f.O1=h.serverVersion,Object(z.f)("[WebViewer Server] server version: "+f.O1)),h.serverID?(f.nx=h.serverID===f.KC&&f.gB?f.nx+1:0,f.KC=h.serverID):f.nx=0,f.gB=!1,f.dm.resolve(h));break;case "health":r?f.dm.reject(r):ca(h,w,f.dm)&&(e=h.unhealthy,this.EM&&(e=h.isDead),!f.j3&&e&&1>=f.nx&&(f.gB=!0,f.gH().then(function(){f.yC()},function(){f.yC()})));break;case "pdf":h.url=f.Ge+"../"+encodeURI(h.url)+
"?bcid="+this.Of.clientId;r?f.Ee.reject(r):ca(h,w,f.Ee)&&f.Ee.resolve(h);break;case "docmod":h.url=f.Ge+"../"+encodeURI(h.url)+"?bcid="+this.Of.clientId;r?f.Fw[h.rID].reject(r):ca(h,w,f.Ee)&&f.Fw[h.rID].resolve(h);break;case "xod":if(r)this.$d&&this.$d.jh()&&this.$d.reject(r),this.Md&&this.Md.jh()&&this.Md.reject(r);else if(h.notFound)h.noCreate||this.$d&&this.$d.jh()&&this.$d.resolve(h),this.Md&&this.Md.jh()&&this.Md.resolve(h);else{h.url&&(h.url=f.Ge+"../"+encodeURI(h.url)+"?bcid="+this.Of.clientId);
if(!this.Md||this.Md.Mm())this.Md=ea(),this.Md.request={t:"xod",noCreate:!0};this.$d||(this.$d=ea(),this.$d.request={t:"xod"});this.Md.resolve(h);this.$d.resolve(h)}break;case "annots":if(r)f.Lf.reject(r);else if(ca(h,w,f.Lf)){f.Lf.$L();var y=new XMLHttpRequest;e=f.Ge+"../"+encodeURI(h.url);var aa=h.hasAppearance?e+".xodapp?bcid="+this.Of.clientId:null;e+="?bcid="+this.Of.clientId;y.open("GET",e);y.responseType="text";y.withCredentials=this.Bm();y.addEventListener("load",function(){y.readyState===
y.DONE&&200===y.status&&f.Lf.resolve({DD:y.response,EG:aa})});y.addEventListener("error",function(){f.Lf.reject(y.statusText+" "+JSON.stringify(y))});y.send()}break;case "image":var ba=this.zf[h.p];r?ba.promise.reject(r):ca(h,w,ba)&&(ba.result=h,ba.result.url=f.Ge+"../"+encodeURI(ba.result.url)+"?bcid="+this.Of.clientId,ba.resolve(ba.result));break;case "tiles":ba=h.rID;e=this.gf[ba];this.gf[ba]=null;this.Ev.push(ba);if(r)e.reject(r);else if(ca(h,w,e)){for(r=0;r<h.tiles.length;r++)h.tiles[r]=f.Ge+
"../"+encodeURI(h.tiles[r])+"?bcid="+this.Of.clientId;e.resolve(h)}break;case "text":ba=this.Ag[h.p];if(r)ba.reject(r);else if(ca(h,w,ba)){ba.$L();var da=new XMLHttpRequest;da.open("GET",f.Ge+"../"+encodeURI(h.url)+"?bcid="+this.Of.clientId);da.withCredentials=this.Bm();da.addEventListener("load",function(){da.readyState===da.DONE&&200===da.status&&(ba.result=JSON.parse(da.response),ba.resolve(ba.result))});da.addEventListener("error",function(e){ba.reject(da.statusText+" "+JSON.stringify(e))});da.send()}break;
case "progress":"loading"===h.t&&f.trigger(n.a.Events.DOCUMENT_LOADING_PROGRESS,[h.bytes,h.total])}},yI:function(){this.ow();return this.dm.promise},JU:function(){this.Lf||(this.Lf=ea(),this.Lf.request={t:"annots"},this.$e(this.Lf.request));return this.Lf.promise},kx:function(e){this.zf[e]||(this.zf[e]=ea(),this.zf[e].request={t:"image",p:e},this.$e(this.zf[e].request));return this.zf[e].promise},EZ:function(e){this.Ag[e]||(this.Ag[e]=ea(),this.Ag[e].request={t:"text",p:e},this.$e(this.Ag[e].request));
return this.Ag[e].promise},FZ:function(e,f,h,n){var r=this.gf.length;this.Ev.length&&(r=this.Ev.pop());this.gf[r]=ea();this.gf[r].request={t:"tiles",p:e,z:f,r:h,size:n,rID:r};this.$e(this.gf[r].request);return this.gf[r].promise},yL:function(){this.Ee||(this.Ee=ea(),this.Ee.request={t:"pdf"},this.Vz?this.Ee.resolve({url:this.bA}):this.$e(this.Ee.request));return this.Ee.promise},QI:function(e){var f=this,h=new XMLHttpRequest,n=this.Ge+"aul?id="+this.id+"&bcid="+this.Of.clientId,r=new FormData,w={};
e.annots&&(w.annots="xfdf");e.watermark&&(w.watermark="png");e.redactions&&(w.redactions="redact");w={t:"docmod",reqID:this.sY++,parts:w};e.print&&(w.print=!0);var y=this.iH(w);r.append("msg",JSON.stringify(y));return Promise.all([e.annots,e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var w=e[0],x=e[1],z=e[2];w&&r.append("annots",w);x&&r.append("watermark",e.watermark);z&&r.append("redactions",z);f.Fw[y.reqID]=ea();h.open("POST",n);h.withCredentials=f.Bm;
h.send(r);return f.Fw[y.reqID].promise})},qJ:function(){this.Md||(this.Md=ea(),this.Md.request={t:"xod",noCreate:!0},this.$e(this.Md.request));return this.Md.promise},GZ:function(){this.$d||(this.$d=ea(),this.$d.request={t:"xod"},this.$e(this.$d.request));return this.$d.promise},ml:function(){return!0},request:function(){},iL:function(){},abort:function(){for(var e=0;e<this.gf.length;e++)this.gf[e]&&(this.gf[e].resolve(null),this.gf[e]=null,this.Ev.push(e));this.close()},tx:function(e){this.Ze=this.Ze||
{};this.Ze.headers=e},H3:function(){return this.Ze?Object(aa.omit)(this.Ze.headers,["Cookie","cookie"]):null},sp:function(e){this.Ze=this.Ze||{};this.Ze.internal=this.Ze.internal||{};this.Ze.internal.withCredentials=e},Bm:function(){return this.Ze&&this.Ze.internal?this.Ze.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(ha.b)(ba);Object(f.a)(ba);Object(f.b)(ba);da["default"]=ba},355:function(ha,da,f){function ba(f){for(var aa="",z=0;z<f;z++)aa+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*
Math.random()));return aa}function ea(f,aa,z){function w(f,e,n){function h(e){w().then(function(f){ca&&!da?setTimeout(function(){h(e)},1):f.send(JSON.stringify(e))})}function r(e,f,r){var w=window.createPromiseCapability(),ha=!1,ia=w;z=e;aa=f;ba=r;y=null;try{e=ea?fa+"/"+ea:fa+"/ws";e+="?bcid="+n;var ja=new WebSocket(e);ja.onopen=function(){w.resolve();ha=!0;w=null;ca=!1;x.resolve(ja);aa&&aa()};ja.onerror=function(e){ca=da=!0;w&&w.reject(e);y&&y.reject()};ja.onclose=function(){x=window.createPromiseCapability();
ca=!0;y||(y=window.createPromiseCapability());y.resolve();ba&&ba();z&&ha&&z({t:"health",data:{unhealthy:!0,isDead:!0}})};ja.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?h({hb:!0}):e.end?close():z(e))}}catch(Aa){w.reject(Aa),w=null}return ia.promise}function w(){ca&&z&&r(z);return x.promise}var x=window.createPromiseCapability(),y=null,z,aa,ba=null,ca=!1,da=!1,ea=e,fa=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);
return h+e.slice(f,n)}(f);return{send:h,kD:r,lA:function(){return y?y.promise:w().then(function(e){y=window.createPromiseCapability();z=null;e.close();return y.promise})},clientId:n}}function r(f){var e=f.lastIndexOf("/");0>e&&(e=f.length);return f.slice(0,e)}var n=ba(8);return window.WebSocket&&!z?w(f,aa,n):function(f,e,n){function h(e){(ca?ca.promise:Promise.resolve(ba)).then(function(f){var h=new XMLHttpRequest;f=aa?z+"/"+aa+"pf?id="+f:z+"/pf?id="+f;f+="&bcid="+n;var r=new FormData;r.append("data",
JSON.stringify(e));h.open("POST",f);h.withCredentials=!0;h.send(r)})}function w(){ba=0;ca||(ca=window.createPromiseCapability())}function x(){y=new XMLHttpRequest;var e=z+"/pf";e=0!==ba?e+("?id="+ba+"&uc="+ja):e+("?uc="+ja);ja++;y.open("GET",e,!0);y.withCredentials=!0;y.setRequestHeader("Cache-Control","no-cache");y.setRequestHeader("X-Requested-With","XMLHttpRequest");var f=y,n=!1;y.onreadystatechange=function(){a:if(3<=f.readyState&&!n){try{var e=f.responseText.length}catch(Ba){Object(fa.f)("caught exception");
break a}if(0<e)try{var r=f.responseText.split("\n");for(r[r.length-1]&&r.pop();0<r.length&&3>r[r.length-1].length;)"]"===r.pop()&&w();0<r.length&&3>r[0].length&&r.shift();for(e=0;e<r.length;++e)r[e].endsWith(",")&&(r[e]=r[e].substr(0,r[e].length-1));0===ba&&0<r.length&&(ba=JSON.parse(r.shift()).id,e=ca,ca=null,e.resolve(ba));var y;for(e=0;e<r.length;++e)(y=JSON.parse(r[e]))&&y.end?close():y&&y.hb&&y.id===ba?h({hb:!0}):ha(y)}catch(Ba){}da||(n=!0,x())}};y.send()}var y,z=r(f),aa=e,ba=0,ca=window.createPromiseCapability(),
da=!1,ea=null,ha=null,ja=0;return{send:h,kD:function(e,f,h){ha=e;ea=h;da=!1;w();x();f&&f();return Promise.resolve()},lA:function(){w();ha=null;da=!0;ea&&ea();y.abort();return Promise.resolve()},clientId:n}}(f,aa,n)}f.d(da,"a",function(){return ea});var fa=f(1)}}]);}).call(this || window)
